
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Homepage Jan Baer">
    <title>Archives - Homepage Jan Baer</title>
    <meta name="author" content="Jan Baer">
    
    
        <link rel="alternative" type="application/atom+xml" title="RSS" href="/atom.xml">
    
    <meta property="og:type" content="blog">
<meta property="og:title" content="Homepage Jan Baer">
<meta property="og:url" content="https://www.janbaer.de/archives/page/2/index.html">
<meta property="og:site_name" content="Homepage Jan Baer">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Homepage Jan Baer">
<meta name="twitter:creator" content="@reabnaj">
    
        <meta rel="publisher" content="https://plus.google.com/+janbaer"/>
    
    
    
        <meta property="og:image" content="/assets/images/https:/avatars2.githubusercontent.com/u/528331?v=3&s=140"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style.min.css">
    <!--STYLES END-->
    
    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-6811781-1']);
        _gaq.push (['_gat._anonymizeIp']);
        _gaq.push(['_trackPageview']);
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>


</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <h1 class="header-title">
        <a class="header-title-link" href="/ ">Homepage Jan Baer</a>
    </h1>
    
        
            <a class="header-right-picture " href="#about">
        
        
            <img class="header-picture" src="https://avatars2.githubusercontent.com/u/528331?v=3&amp;s=140">
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="1">
    
        <div class="sidebar-profile">
            <a href="/#about">
                    <img class="sidebar-profile-picture" src="https://avatars2.githubusercontent.com/u/528331?v=3&amp;s=140">
            </a>
            <span class="sidebar-profile-name">Jan Baer</span>
        </div>
    
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a class="sidebar-button-link " href="/ ">
                
                    <i class="sidebar-button-icon fa fa-lg fa-home"></i>
                    <span class="sidebar-button-desc">Home</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a class="sidebar-button-link " href="/projects.html">
                
                    <i class="sidebar-button-icon fa fa-lg fa-book"></i>
                    <span class="sidebar-button-desc">MyProjects</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a class="sidebar-button-link " href="/all-categories">
                
                    <i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
                    <span class="sidebar-button-desc">Categories</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a class="sidebar-button-link " href="/all-tags">
                
                    <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
                    <span class="sidebar-button-desc">Tags</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a class="sidebar-button-link " href="/all-archives">
                
                    <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
                    <span class="sidebar-button-desc">Archives</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a class="sidebar-button-link " href="#about">
                
                    <i class="sidebar-button-icon fa fa-lg fa-question"></i>
                    <span class="sidebar-button-desc">About</span>
                </a>
        </li>
        
    </ul>
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a class="sidebar-button-link " href="https://github.com/janbaer" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-github"></i>
                    <span class="sidebar-button-desc">GitHub</span>
                </a>
        </li>
        
            <li class="sidebar-button">
                
                    <a class="sidebar-button-link " href="https://twitter.com/reabnaj" target="_blank">
                
                    <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
                    <span class="sidebar-button-desc">Twitter</span>
                </a>
        </li>
        
    </ul>
    
        <ul class="sidebar-buttons">
        
            <li class="sidebar-button">
                
                    <a class="sidebar-button-link " href="/atom.xml">
                
                    <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
                    <span class="sidebar-button-desc">RSS</span>
                </a>
        </li>
        
    </ul>
    
</nav>

            
            <div id="main" data-behavior="1"
                 class="
                        hasCoverMetaIn
                        ">
                
    

<section class="postShorten-group main-content-wrap">
    
        
        <article class="postShorten postShorten--thumbnailimg-bottom" itemscope="" itemtype="http://schema.org/BlogPosting">
            <div class="postShorten-wrap">
                <div class="postShorten-header">
                    <h1 class="postShorten-title" itemprop="headline">
                        
                                <a class="link-unstyled" href="/2013/04/01/2013-04-01-set-acl-with-powershell/">Set-acl with Powershell</a>
                        
                    </h1>
                    <div class="postShorten-meta">
    <time itemprop="datePublished" content="Mon Apr 01 2013 00:00:00 GMT+0200">
	
		    Apr 01, 2013
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/develop/">develop</a>


    
</div>
                </div>
                
                
                    <div class="postShorten-content" itemprop="articleBody">
                        <p>In meinem letzten Projekt war eine meiner Aufgaben, ein Script zu erstellen, das eine definierte Verzeichnisstruktur erstellt und einem bestimmten User die notwendigen Zugriffrechte darauf gibt.<br>Weiterhin sollte das Script dann im IIS eine Website mit einem eigenen AppPool in diesem Verzeichnis erstellen.</p>
<p>Ich hatte mich entschieden, das Script mit Powershell zu erstellen, da es hier schon fertige Module von Microsoft gibt, um den IIS zu verwalten, ohne das man dies über WMI machen müsste.</p>
<p>Um dieses Modul allerdings zu verwenden, muss man es in Powershell erst einmal importieren. Das macht man ganz einfach mit foldener Codezeile.</p>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">Import</span>-<span class="keyword">Module</span> -<span class="keyword">Name</span> WebAdministration</div></pre></td></tr></table></figure>
<p>Damit das Module importiert werden kann, muss der IIS mit den Management Services installiert sein. Will man prüfen, ob das Modul auch wirklich installiert ist, so kann man das mit folgendem Code machen und im negativen Fall den Benutzer darauf hinweisen.</p>
<figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="string">if </span>((<span class="built_in">get-module</span> -<span class="string">name </span><span class="string">WebAdministration </span>-<span class="string">erroraction </span><span class="string">silentlycontinue)</span> -<span class="string">eq </span>$<span class="string">false)</span> &#123;</div><div class="line"><span class="string">Write-Host </span><span class="string">"The Powershell module for WebAdministration is not installed! Please check your IIS installation!"</span> -f <span class="string">Red</span></div><div class="line"><span class="string">return</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Die Website erstellt man dann mit folgendem Code</p>
<figure class="highlight cos"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">$integrated</span> = <span class="number">0</span></div><div class="line"><span class="keyword">New</span>-WebAppPool -Name <span class="built_in">$appPoolName</span></div><div class="line"><span class="keyword">Set</span>-ItemProperty IIS:AppPools\<span class="built_in">$appPoolName</span> managedRuntimeVersion v4.0</div><div class="line"><span class="keyword">Set</span>-ItemProperty IIS:AppPools\<span class="built_in">$appPoolName</span> managedPipelineMode <span class="built_in">$integrated</span></div><div class="line"><span class="keyword">New</span>-Website -Name <span class="built_in">$webServiceName</span> -PhysicalPath <span class="built_in">$directoryPath</span> -ApplicationPool <span class="built_in">$appPoolName</span></div><div class="line">Remove-WebBinding -Name <span class="built_in">$webServiceName</span></div><div class="line"><span class="keyword">New</span>-WebBinding -Name <span class="built_in">$webServiceName</span> -IPAddress <span class="string">"*"</span> -Port <span class="built_in">$port</span> -HostHeader <span class="built_in">$webServiceName</span></div></pre></td></tr></table></figure>
<p>Seit IIS7 ist es so, das der AppPool nicht mehr wie früher mit dem Account <strong>NetworkService</strong> läuft sondern es dafür eigene <strong>IIS AppPool</strong> Identities gibt. Wenn man einen neuen AppPool erstellt, läuft dieser unter dem Benutzer <strong>IIS AppPools\AppPoolname</strong>. Es müssen diesem Benutzer noch die Zugriffsrechte auf das Verzeichnis gegeben werden. Normalerweise sollten diesem Benutzer nur auf bestimmte Verzeichniss, wie das Log-Verzeichnis Schreibrechte gegeben werden. Auf die anderen Verzeichniss reichen Lesezugriffsrechte. Auch hierfür hat die Powershell schon die notwendigen Commandlets an Board.</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$acl</span> = Get-Acl -Path <span class="variable">$directory</span></div><div class="line"><span class="variable">$userAccount</span> = New-Object System<span class="selector-class">.Security</span><span class="selector-class">.Principal</span><span class="selector-class">.NTAccount</span>(<span class="string">"IIS AppPool"</span>, <span class="variable">$userName</span>)</div><div class="line"><span class="variable">$permission</span> = <span class="variable">$userAccount</span>, <span class="variable">$right</span>, <span class="string">"ContainerInherit,ObjectInherit"</span>, <span class="string">"None"</span>, <span class="string">"Allow"</span></div><div class="line"><span class="variable">$right</span> = New-Object System<span class="selector-class">.Security</span><span class="selector-class">.AccessControl</span><span class="selector-class">.FileSystemAccessRule</span> <span class="variable">$permission</span></div><div class="line"><span class="variable">$acl</span>.SetAccessRule(<span class="variable">$right</span>)</div><div class="line">Set-Acl -AclObject <span class="variable">$acl</span> -Path <span class="variable">$directory</span></div></pre></td></tr></table></figure>
<p>Die meisten Codebeispiele erstellen die Permission mit der folgenden Codezeile</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$permission = $userAccount, $right</div></pre></td></tr></table></figure>
<p>Das hat aber den Nachteil, das sich diese Berechtigung nicht auf neue Unterordner veerbt. Deswegen ist die erste Variante in den meisten Fällen sicher die zu bevorzugende.</p>

                        
                        
                            <p>
                                <a href="/2013/04/01/2013-04-01-set-acl-with-powershell/#post-footer" class="postShorten-excerpt_link link">
                                    Comment and share
                                </a>
                            </p>
                        
                    </div>
                
            </div>
            
        </article>
    
        
        <article class="postShorten postShorten--thumbnailimg-bottom" itemscope="" itemtype="http://schema.org/BlogPosting">
            <div class="postShorten-wrap">
                <div class="postShorten-header">
                    <h1 class="postShorten-title" itemprop="headline">
                        
                                <a class="link-unstyled" href="/2013/03/04/2013-03-04-linqperformancetips/">LinqPerformanceTips</a>
                        
                    </h1>
                    <div class="postShorten-meta">
    <time itemprop="datePublished" content="Mon Mar 04 2013 00:00:00 GMT+0100">
	
		    Mar 04, 2013
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/develop/">develop</a>


    
</div>
                </div>
                
                
                    <div class="postShorten-content" itemprop="articleBody">
                        <p>In my latest project I learned some thinks about the performance of Linq when you often query in-memory repositories. Linq is very easy to use and with that you can very quick implement the methods that you need for an repository. But sometimes it’s useful to think a little bit more how often a method will be called. In my latest project I had the situation to call the <strong>GetById</strong> method for more than 20.000 times. And my in-memory repository had more than 700 items. In my first attempt I have used the <strong>SingleOrDefault</strong> method to return the correct item. But this was not fast enough. My function has needed more than 2 seconds in sum. My second attempt was, to convert the items into a Dictionary with the id as key and use this dictionary in the <em>GetById</em> function. And this was so much faster. It needs just 220 ms for all calls and this was the performance that I needed.</p>
<p>To generate a dictionary very quick, you can use an extension method from the <strong>System.Linq</strong>     namespace. With the following code you can do this very easy</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">items.ToDictionary(<span class="function"><span class="params">i</span> =&gt;</span> i.Id);</div></pre></td></tr></table></figure>
<p>The same experience I made with the query for any items with the same key. The Linq function <strong>SelectMany</strong> was in summary to slow. In this situation you can’t use a dictionary because the key isn’t unique. But Linq has also an Extension method to solve this problem. With the <strong>ToLookup</strong> function you can generate a very fast lookup table.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">items.ToLookup(<span class="function"><span class="params">i</span> =&gt;</span> i.&#123;PropertyToLookup&#125;);</div></pre></td></tr></table></figure>

                        
                        
                            <p>
                                <a href="/2013/03/04/2013-03-04-linqperformancetips/#post-footer" class="postShorten-excerpt_link link">
                                    Comment and share
                                </a>
                            </p>
                        
                    </div>
                
            </div>
            
        </article>
    
        
        <article class="postShorten postShorten--thumbnailimg-bottom" itemscope="" itemtype="http://schema.org/BlogPosting">
            <div class="postShorten-wrap">
                <div class="postShorten-header">
                    <h1 class="postShorten-title" itemprop="headline">
                        
                                <a class="link-unstyled" href="/2013/02/26/2013-02-26-csvtojsonwithpowershell/">Csv to Json with Powershell</a>
                        
                    </h1>
                    <div class="postShorten-meta">
    <time itemprop="datePublished" content="Tue Feb 26 2013 00:00:00 GMT+0100">
	
		    Feb 26, 2013
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/develop/">develop</a>


    
</div>
                </div>
                
                
                    <div class="postShorten-content" itemprop="articleBody">
                        <p>In my current project I have got some .csf files with the requirement to import these files<br>to my project as base data to use it as inmemory repository.</p>
<p>The best solution was these single line of code in powershell.</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">Get-Content</span> -path <span class="variable">$inputFile</span> | <span class="built_in">ConvertFrom-Csv</span> -Delimiter <span class="string">';'</span> | <span class="built_in">ConvertTo-Json</span> | <span class="built_in">Out-File</span> <span class="variable">$outputFile</span></div></pre></td></tr></table></figure>
<p>You can download the complete powershell script from my <a href="https://gist.github.com/janbaer/5045798" target="_blank" rel="external">gist repository</a> at github.</p>

                        
                        
                            <p>
                                <a href="/2013/02/26/2013-02-26-csvtojsonwithpowershell/#post-footer" class="postShorten-excerpt_link link">
                                    Comment and share
                                </a>
                            </p>
                        
                    </div>
                
            </div>
            
        </article>
    
    <div class="pagination-bar">
    <ul class="pagination">
        
        <li class="pagination-prev">
            
                <a class="btn btn--default btn--small" href="/ ">
            
                <i class="fa fa-angle-left text-base icon-mr"></i>
                    <span>NEWER POSTS</span>
            </a>
        </li>
        
        
        <li class="pagination-number">page 2 of 2</li>
    </ul>
</div>

</section>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2018 Jan Baer. All Rights Reserved.
    </span>
</footer>

            </div>
            
        </div>
        <!-- Define author's picture -->


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <img id="about-card-picture" src="https://avatars2.githubusercontent.com/u/528331?v=3&amp;s=140">
        
            <h4 id="about-card-name">Jan Baer</h4>
        
            <h5 id="about-card-bio"><p>I’m a passionated Softwaredeveloper from Munich.</p>
</h5>
        
        
            <h5 id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br>
                <p>Softwaredeveloper</p>

            </h5>
        
        
            <h5 id="about-card-location">
                <i class="fa fa-map-marker"></i>
                <br>
                Germany
            </h5>
        
    </div>
</div>

        
<div id="cover" style="background-image:url('/assets/images/cover.jpg');"></div>
    </body>
    <!--SCRIPTS-->
<script src="/assets/js/script.min.js"></script>
<!--SCRIPTS END-->



</html>
